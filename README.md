# OpenCensus Metrics Filter

This code creates metrics filter that can be easily applied to Java applications as a filter.
This is very useful for Cloud Run Java Applications where the metrics endpoint is not available as you cannot access each instance.

Change the active method to `googleStackdriver` to push the metrics to Stackdriver. This creates custom metrics in Monitoring.

Run the application using 

```bash
./gradlew run
```
This will run the application locally on `http://localhost:8080`

You will also need to start a local instance of prometheus to check the labels that are created using

```bash
prometheus --config.file=promconfig.yaml
```

Metrics can be generated by called the endpoints, such as: `http://localhost:8080/country?country=FR`

The metrics will be exposed on: `http://localhost:8889/metrics` when using `setupPrometheusExporter`

The metrics will be exported to Prometheus and can be viewed using:

- `http://localhost:9090/graph?g0.range_input=1h&g0.expr=application_response&g0.tab=1`

- `http://localhost:9090/graph?g0.range_input=1h&g0.expr=application_latency&g0.tab=1`

